\subsection{Парадигма Fork-Join}

В параллельном программировании, Fork-Join model (модель ветвление-объединение, FJM) -- это способ запуска и выполнения параллельных участков кода, при котором выполнение ветвей завершается в специально обозначенном месте для того, чтобы в следующей точке продолжить последовательное выполнение. Параллельные участки могут разветвляться рекурсивно до тех пор, пока не будет достигнута заданная степень гранулярности задачи. Модель была впервые сформулирована в 1963 г., и может рассматриваться как один из параллельных паттернов проектирования\cite{McCool2013}.

Различные реализации FJM обычно управляют \textit{задачами}, \textit{волокнами} или \textit{легковесными нитями}, а не \textit{процессами} уровня операционной системы, и используют \textit{пул потоков} для их выполнения. Специальные ключевые слова позволяют программисту определять точки \textit{возможного параллелизма}; проблема создания реальных потоков и управления ими ложится на реализацию.

В~\cite{WikiForkJoin2015} приведена иллюстрация парадигмы Fork-Join. Представим ее на рисунке~\ref{fig:Fjm}. Здесь три участка программы потенциально разрешают параллельное исполнение различных блоков. Последовательное выполнение показано сверху, в то время как его Fork-Join эквивалент снизу.

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{Figures/ForkJoin}
\caption{\label{fig:Fjm} Иллюстрация парадигмы Fork-Join}
\end{figure}

Легковесные нити, используемые в Fork-Join программировании, обычно имеют свой собственный планировщик, который управляет ими, применяя схему пула потоков. Такой планировщик может быть гораздо проще полнофункционального планировщика задач, применяемого операционной системой. Планировщики потоков общего пользования обязаны приостанавливать/запускать потоки в обозначенных программистом местах, в то время как в парадигме Fork-Join потоки блокируются только в местах непосредственного слияния.

Модель Fork-Join -- основная модель параллельного исполнения в технологии OpenMP. Также эта модель поддерживается в Java concurrency framework, в Task Parallel Library для .NET и в Intel Threading Building Blocks. Языки программирования Cilk и Cilk Plus имеют встроенную поддержку FJM в форме ключевых слов \textit{spawn}--\textit{sync} и \textit{cilk\_spawn}--\textit{cilk\_sync} соответственно.